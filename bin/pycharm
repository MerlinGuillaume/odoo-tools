#!/usr/bin/fish

set recent_projects (workspace -l)
set workspaces ~/src/$recent_projects
set pycharm_bin (fd pycharm.sh ~/.local/share/JetBrains/Toolbox/apps/PyCharm-P/ch-0/*/bin | sort -r | head -n1)

if not test -f $pycharm_bin
    notify-send (basename $i)" moved"
    exit 1
end

function open
    setsid $pycharm_bin $argv &>/dev/null &
end

set choice (workspace -p)
if test $status -ne 0
    set lines (count $workspaces)
    set choice (echo $workspaces | string split ' ' | rofi -lines $lines -dmenu -p pycharm -no-default-config)
end

if test -d "$choice"
    open $choice
else
    exit 1
end
