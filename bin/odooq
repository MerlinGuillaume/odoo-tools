#!/usr/bin/fish

function query
  psql --csv -d $argv[1] -c $argv[2] | tail -n+2
end

argparse 'd/database=' -- $argv

if not set -q _flag_database
  set _flag_database (workspace -v) || exit 1
end

# queries
set installed "select name from ir_module_module where state = 'installed' order by name"

if not set -q $argv[1]
  exit 1
end

query $_flag_database $$argv[1]
